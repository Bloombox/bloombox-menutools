
<!--
`<bloombox-menutools>` provides tools for filtering and editing menu entries.

@group Bloombox Elements
@element bloombox-menutools
@demo demo/index.html
@homepage bloombox.github.io
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-iconset-svg/iron-iconset-svg.html">
<link rel="import" href="../iron-iconset/iron-iconset.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bloombox-styles/bloombox-styles.html">


<dom-module id="bloombox-menutools">
  <template>
    <style is="custom-style" include="bloombox-styles">
      :host {
        margin-left: 1em;
      }

      :host .hidden {
        display: none;
      }

      paper-button[active] {
        background-color: #4c9d2f;
        color: white;
      }

      .menu-root {
        display: inline-block;
        height: 65px;
      }

      .menu-section {
        display: inline-block;
        height: 65px;
      }

      .menu-section:last-child {
        border-right: none;
      }

      #manageLocations {
        position: relative;
        margin-left: 20px;
        margin-right: 40px;
      }

      .menu-section.filters {
        position: relative;
        margin-left: 20px;
      }

      .menu-section.display {
        position: relative;
        top: 3px;
        margin-left: 20px;
      }

      :host div.hidden {
        display: none;
      }

      paper-tab[link] a {
        /* These mixins (from iron-flex-layout) center the link text. */
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        color: #111;
        text-decoration: none;
        --paper-tabs-selection-bar-color: blue;
        --paper-tab-ink: blue;
      }
    </style>

    <div class="menu-root">
      <!-- context -->
      <div class="menu-section context">
        <paper-dropdown-menu label="Location" noink>
          <paper-listbox class="dropdown-content" selected="{{location}}" attr-for-selected="key">
            <template is="dom-repeat" items="{{locations}}">
              <paper-item key="[[item.key]]">[[item.label]]</paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
      </div>

      <!-- filters -->
      <div class="menu-section filters">
        <paper-button id="inStock" active="{{instock}}" toggles on-tap="_didToggleInStockOnly">In-Stock Only</paper-button>
      </div>

      <!-- display mode -->
      <div class="menu-section display">
        <paper-button hidden id="displayModeSlim" on-tap="activateSlimDisplayMode" toggles><iron-icon icon="icons:list"></iron-icon></paper-button>
        <paper-button hidden id="displayModeList" on-tap="activateListDisplayMode" active toggles><iron-icon icon="icons:view-list"></iron-icon></paper-button>
        <paper-button hidden id="displayModeCards" on-tap="activateCardDisplayMode" toggles><iron-icon icon="icons:dashboard"></iron-icon></paper-button>
      </div>
    </div>
  </template>

  <script>
    Polymer.BloomboxMenutools = Polymer({
      is: 'bloombox-menutools',

      properties: {
        /**
         * Partner locations that can be selected for menu viewing/editing. This is
         * an array of objects, where each object is a `location` passed in from the
         * server.
         */
        locations: {
          type: Array,
          notify: true
        },

        /**
         * Provides the active, selected `location` key.
         */
        location: {
          type: String,
          notify: true
        },

        /**
         * Boolean flag indicating that we only wish to see in-stock items in the
         * menu viewer/editor.
         */
        instock: {
          type: Boolean,
          value: true,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Display mode setting for menu UI. Options are `list`, `cards`, and
         * `slim`.
         */
        displayMode: {
          type: String,
          notify: true,
          value: "list",
          reflectToAttribute: true
        }
      },

      /**
       * UI responder that is executed when the user changes the state of the "show
       * instock only" button.
       */
      _didToggleInStockOnly: function() {
        this.fire("menu-instock-changed");
      },

      /**
       * Activate a display mode where menu items are placed in a list-style UI.
       */
      activateListDisplayMode: function() {
        this.fire("menu-displaymode-changed");
        this.$.displayModeSlim.active = false;
        this.$.displayModeList.active = true;
        this.$.displayModeCards.active = false;
        bloom.app.classList.remove("display-mode-cards");
        bloom.app.classList.remove("display-mode-slim");
        bloom.app.classList.add("display-mode-list");
        this.set("displayMode", "normal");
      },

      /**
       * Activate a display mode where menu items are placed in an expanded
       * card-style UI.
       */
      activateSlimDisplayMode: function() {
        this.fire("menu-displaymode-changed");
        this.$.displayModeSlim.active = true;
        this.$.displayModeList.active = false;
        this.$.displayModeCards.active = false;

        bloom.app.classList.remove("display-mode-cards");
        bloom.app.classList.remove("display-mode-list");
        bloom.app.classList.add("display-mode-slim");
        this.set("displayMode", "slim");
      },

      /**
       * Activate a display mode where menu items are placed in a full, naturally-
       * flowed card style UI.
       */
      activateCardDisplayMode: function() {
        this.fire("menu-displaymode-changed");
        this.$.displayModeSlim.active = false;
        this.$.displayModeList.active = false;
        this.$.displayModeCards.active = true;

        bloom.app.classList.remove("display-mode-slim");
        bloom.app.classList.remove("display-mode-list");
        bloom.app.classList.add("display-mode-cards");
        this.set("displayMode", "normal");
      }
    });
  </script>
</dom-module>
