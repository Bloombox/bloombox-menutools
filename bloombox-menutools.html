
<!--
`<bloombox-menutools>` provides tools for filtering and editing menu entries.

@group Bloombox Elements
@element bloombox-menutools
@demo demo/index.html
@homepage bloombox.github.io
-->

<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">

<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">

<link rel="import" href="../bloombox-icons/bloombox-icons.html">
<link rel="import" href="../bloombox-styles/bloombox-styles.html">


<dom-module id="bloombox-menutools">
  <template>
    <style is="custom-style" include="bloombox-styles">
      :host {
      }

      :host .hidden {
        display: none;
      }

      :host #inStock,
      :host #onSale {
        font-size: 10pt;
        max-height: 30px;
        position: relative;
        top: 8px;
        min-width: 120px;
      }

      .menu-root {
        display: flex;
      }

      .menu-section {
        display: flex;
      }

      .menu-section:last-child {
        border-right: none;
      }

      .menu-section.context paper-dropdown-menu {
        margin-right: 20px;
        margin-left: 20px;
      }

      .menu-section.filters {
        position: relative;
      }

      :host div.hidden {
        display: none;
      }

      :host paper-radio-group {
        border: 1px solid #ddd;
        margin-left: 10px;
        min-width: 250px;
        white-space: nowrap;
      }

      paper-tab[link] a {
        /* These mixins (from iron-flex-layout) center the link text. */
        @apply(--layout-horizontal);
        @apply(--layout-center-center);
        color: #111;
        text-decoration: none;
        --paper-tabs-selection-bar-color: blue;
        --paper-tab-ink: blue;
      }
    </style>

    <div class="menu-root">
      <!-- context -->
      <div class="menu-section context">
        <paper-dropdown-menu label="Location" noink no-label-float hidden$="[[!_hasMultipleLocations]]">
          <paper-listbox class="dropdown-content" selected="{{location}}" attr-for-selected="key">
            <template is="dom-repeat" items="[[locations]]">
              <paper-item key="[[item.key]]">[[item.label]]</paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
      </div>

      <!-- filters -->
      <div class="menu-section filters">
        <paper-button id="inStock" active="{{instock}}" toggles on-tap="_didToggleInStockOnly">In-Stock Only</paper-button>
        <paper-button id="onSale" active="{{sale}}" toggles on-tap="_didToggleOnSaleOnly">On-Sale Only</paper-button>
        <paper-radio-group
          attr-for-selected="name"
          selected="{{hasTests}}"
          aria-labelledby="unitLabel">
          <paper-radio-button name="all">All</paper-radio-button>
          <paper-radio-button name="tests">Tests</paper-radio-button>
          <paper-radio-button name="notests">No Tests</paper-radio-button>
        </paper-radio-group>
      </div>
    </div>
  </template>

  <script>
    Polymer.BloomboxMenutools = Polymer({
      is: 'bloombox-menutools',

      properties: {
        /**
         * Observes the length of `locations` and reports whether there are more
         * than 1, so we may show and hide the location selection UI.
         */
        _hasMultipleLocations: {
          type: Boolean,
          notify: true,
          computed: '_computeHasMultipleLocations(locations.length)'
        },

        /**
         * Partner locations that can be selected for menu viewing/editing. This is
         * an array of objects, where each object is a `location` passed in from the
         * server.
         */
        locations: {
          type: Array,
          notify: true
        },

        /**
         * Provides the active, selected `location` key.
         */
        location: {
          type: String,
          notify: true
        },

        /**
         * Boolean flag indicating that we only wish to see in-stock items in the
         * menu viewer/editor.
         */
        instock: {
          type: Boolean,
          value: true,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Boolean flag indicating that we only wish to see in-stock items in the
         * menu viewer/editor.
         */
        sale: {
          type: Boolean,
          value: false,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Filter state that controls the display of products with, without, or
         * regardless-of the presence of test data.
         */
        hasTests: {
          type: String,
          value: "all",
          notify: true,
          reflectToAttribute: true
        }
      },

      /**
       * Computes whether we should show or hide the location selection UI.
       */
      _computeHasMultipleLocations: function(count) {
        return count > 1;
      },

      /**
       * UI responder that is executed when the user changes the state of the "show
       * instock only" button.
       */
      _didToggleInStockOnly: function() {
        this.fire("menu-instock-changed");
        this.fire("menu-filters-changed");
      },

      /**
       * UI responder that is executed when the user changes the state of the "show
       * onsale only" button.
       */
      _didToggleOnSaleOnly: function() {
        this.fire("menu-onsale-changed");
        this.fire("menu-filters-changed");
      }
    });
  </script>
</dom-module>
